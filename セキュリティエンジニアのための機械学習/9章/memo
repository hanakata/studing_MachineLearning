深層強化学習によるマルウェア検知器の回避

実世界のアンチウィルス製品に存在した問題
    最近のアンチウィルスソフトは機械学習を利用したものが多くある
        それ自体を攻撃対象として攻撃し回避することが可能

機械学習を用いるマルウェア検知器MalConv
    MalConv
        畳み込みニューラルネットワークを用いたマルウェア分類器
            分類対象はPEファイルやexe、dllなど

Machine Learning Static Evasion Competiton
    大会においてMalConvは回避可能なことが分かった
        複数回避方法は存在する
            検討事項
                改変方法
                探索方法

PEファイルフォーマットの基礎知識
    ヘッダ
        DOSヘッダ
        PEヘッダ
        オプショナルヘッダ
        データディレクトリ
        セクションテーブル
            これらのうち以下の内容は依存した動作をしていない限り変更しても問題ない
                DOSヘッダの文字列
                PEヘッダ内のコンパイル日時
                オプショナルヘッダの予約済みメンバーやチェックサム
        PEファイルに含まれるセクション
            コードセクション
            インポートセクション
            データセクション
                これらを安易に書き換える分けにはいかない
                    どうするか？
                        オーバーレイの追加
                        コードケイブの悪用
                        セクション名の偏向
                        セクションの追加

pefileを用いたPEファイルの改変

マルウェア検知を機械学習によって回避するには
    ファイルフォーマットから逸脱する改変は攻撃が動作しなくなる
        オーバーレイを追加する
            一部のマルウェア分類器は入力の一定サイズしか使わないのでそれをオーバーしないように
                これを回避するには
                    コードケイブを悪用する方法
                        入力サイズをいじれる
                    偽のインポート関数を2つ追加

深層強化学習の基礎知識
    強化学習という問題をディープラーニングを用いて解く手法
    問題設定
        ある環境における行動の主体が刻々と変化する状態にたいして選択した行動により報酬を得る   
            累積報酬が最も高くなる行動を選択する

OpenAIGymとKeras-RLを用いたMalConvの回避

用語